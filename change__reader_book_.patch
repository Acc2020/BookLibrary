Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/workspace.xml	(revision 84f4180d3f8271428da2cf06e57b1fc961c0e900)
+++ .idea/workspace.xml	(date 1558789575947)
@@ -3,6 +3,8 @@
   <component name="ChangeListManager">
     <list default="true" id="a28ed973-43a7-45e9-99bc-ec2a579fd138" name="Default Changelist" comment="">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/book.db" beforeDir="false" afterPath="$PROJECT_DIR$/book.db" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/book.py" beforeDir="false" afterPath="$PROJECT_DIR$/book.py" afterDir="false" />
     </list>
     <option name="EXCLUDED_CONVERTED_TO_IGNORED" value="true" />
     <option name="SHOW_DIALOG" value="false" />
@@ -13,45 +15,10 @@
   <component name="FileEditorManager">
     <leaf SIDE_TABS_SIZE_LIMIT_KEY="300">
       <file pinned="false" current-in-tab="true">
-        <entry file="file://$PROJECT_DIR$/README.md">
-          <provider selected="true" editor-type-id="split-provider[text-editor;markdown-preview-editor]">
-            <state split_layout="SPLIT">
-              <first_editor relative-caret-position="442">
-                <caret line="17" column="46" lean-forward="true" selection-start-line="17" selection-start-column="46" selection-end-line="17" selection-end-column="46" />
-              </first_editor>
-              <second_editor />
-            </state>
-          </provider>
-        </entry>
-      </file>
-      <file pinned="false" current-in-tab="false">
-        <entry file="file://$PROJECT_DIR$/book.db">
-          <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="234">
-              <caret line="9" column="1023" selection-start-line="9" selection-start-column="1023" selection-end-line="9" selection-end-column="1023" />
-            </state>
-          </provider>
-        </entry>
-      </file>
-      <file pinned="false" current-in-tab="false">
-        <entry file="file://$PROJECT_DIR$/book.sql">
-          <provider selected="true" editor-type-id="text-editor" />
-        </entry>
-      </file>
-      <file pinned="false" current-in-tab="false">
-        <entry file="file://$PROJECT_DIR$/books.txt">
-          <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="130">
-              <caret line="5" selection-start-line="5" selection-end-line="5" />
-            </state>
-          </provider>
-        </entry>
-      </file>
-      <file pinned="false" current-in-tab="false">
         <entry file="file://$PROJECT_DIR$/book.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="8684">
-              <caret line="341" column="18" selection-start-line="341" selection-start-column="18" selection-end-line="341" selection-end-column="18" />
+            <state relative-caret-position="167">
+              <caret line="367" column="16" lean-forward="true" selection-start-line="367" selection-start-column="16" selection-end-line="367" selection-end-column="16" />
               <folding>
                 <element signature="e#24#35#0" expanded="true" />
               </folding>
@@ -61,38 +28,19 @@
       </file>
       <file pinned="false" current-in-tab="false">
         <entry file="file://$PROJECT_DIR$/templates/reader_book.html">
-          <provider selected="true" editor-type-id="text-editor" />
-        </entry>
-      </file>
-      <file pinned="false" current-in-tab="false">
-        <entry file="file://$PROJECT_DIR$/templates/reader.html">
-          <provider selected="true" editor-type-id="text-editor" />
-        </entry>
-      </file>
-      <file pinned="false" current-in-tab="false">
-        <entry file="file://$PROJECT_DIR$/templates/manager_userinfo.html">
-          <provider selected="true" editor-type-id="text-editor" />
-        </entry>
-      </file>
-      <file pinned="false" current-in-tab="false">
-        <entry file="file://$PROJECT_DIR$/templates/manager_modify.html">
-          <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="754">
-              <caret line="29" column="11" selection-start-line="29" selection-start-column="11" selection-end-line="29" selection-end-column="11" />
-            </state>
-          </provider>
-        </entry>
-      </file>
-      <file pinned="false" current-in-tab="false">
-        <entry file="file://$PROJECT_DIR$/templates/manager_books.html">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="156">
-              <caret line="6" column="14" selection-start-line="6" selection-start-column="14" selection-end-line="6" selection-end-column="14" />
+            <state relative-caret-position="962">
+              <caret line="37" lean-forward="true" selection-start-line="37" selection-end-line="37" />
             </state>
           </provider>
         </entry>
       </file>
     </leaf>
+  </component>
+  <component name="FindInProjectRecents">
+    <findStrings>
+      <find>reader/book</find>
+    </findStrings>
   </component>
   <component name="Git.Settings">
     <option name="PREVIOUS_COMMIT_AUTHORS">
@@ -110,8 +58,8 @@
       <list>
         <option value="$PROJECT_DIR$/templates/layout.html" />
         <option value="$PROJECT_DIR$/book.db" />
-        <option value="$PROJECT_DIR$/book.py" />
         <option value="$PROJECT_DIR$/README.md" />
+        <option value="$PROJECT_DIR$/book.py" />
       </list>
     </option>
   </component>
@@ -126,9 +74,9 @@
       </list>
     </option>
   </component>
-  <component name="ProjectFrameBounds" extendedState="6">
-    <option name="x" value="1175" />
-    <option name="y" value="122" />
+  <component name="ProjectFrameBounds">
+    <option name="x" value="626" />
+    <option name="y" value="148" />
     <option name="width" value="1400" />
     <option name="height" value="970" />
   </component>
@@ -137,6 +85,7 @@
       <foldersAlwaysOnTop value="true" />
     </navigator>
     <panes>
+      <pane id="Scope" />
       <pane id="ProjectPane">
         <subPane>
           <expand>
@@ -162,7 +111,6 @@
           <select />
         </subPane>
       </pane>
-      <pane id="Scope" />
     </panes>
   </component>
   <component name="PropertiesComponent">
@@ -249,25 +197,33 @@
       <option name="project" value="LOCAL" />
       <updated>1558281856121</updated>
     </task>
-    <option name="localTasksCounter" value="5" />
+    <task id="LOCAL-00005" summary="change name">
+      <created>1558282124250</created>
+      <option name="number" value="00005" />
+      <option name="presentableId" value="LOCAL-00005" />
+      <option name="project" value="LOCAL" />
+      <updated>1558282124250</updated>
+    </task>
+    <option name="localTasksCounter" value="6" />
     <servers />
   </component>
   <component name="ToolWindowManager">
-    <frame x="-8" y="-8" width="1936" height="1056" extended-state="6" />
+    <frame x="626" y="148" width="1400" height="970" extended-state="0" />
+    <editor active="true" />
     <layout>
-      <window_info active="true" content_ui="combo" id="Project" order="0" visible="true" weight="0.17913593" />
+      <window_info active="true" content_ui="combo" id="Project" order="0" visible="true" weight="0.2496329" />
       <window_info id="Structure" order="1" side_tool="true" weight="0.25" />
       <window_info id="Favorites" order="2" side_tool="true" />
       <window_info anchor="bottom" id="Message" order="0" />
       <window_info anchor="bottom" id="Find" order="1" />
-      <window_info anchor="bottom" id="Run" order="2" weight="0.30477223" />
+      <window_info anchor="bottom" id="Run" order="2" sideWeight="0.4992658" visible="true" weight="0.30382776" />
       <window_info anchor="bottom" id="Debug" order="3" weight="0.4" />
       <window_info anchor="bottom" id="Cvs" order="4" weight="0.25" />
       <window_info anchor="bottom" id="Inspection" order="5" weight="0.4" />
       <window_info anchor="bottom" id="TODO" order="6" />
-      <window_info anchor="bottom" id="Version Control" order="7" sideWeight="0.49736565" visible="true" weight="0.3286334" />
+      <window_info anchor="bottom" id="Version Control" order="7" sideWeight="0.49632892" weight="0.36200717" />
       <window_info anchor="bottom" id="Terminal" order="8" sideWeight="0.49947312" weight="0.329718" />
-      <window_info anchor="bottom" id="Event Log" order="9" sideWeight="0.50263435" side_tool="true" visible="true" weight="0.3286334" />
+      <window_info anchor="bottom" id="Event Log" order="9" sideWeight="0.5007342" side_tool="true" visible="true" weight="0.30382776" />
       <window_info anchor="bottom" id="Python Console" order="10" />
       <window_info anchor="right" id="Commander" internal_type="SLIDING" order="0" type="SLIDING" weight="0.4" />
       <window_info anchor="right" id="Ant Build" order="1" weight="0.25" />
@@ -361,8 +317,8 @@
     <entry file="file://$PROJECT_DIR$/README.md">
       <provider selected="true" editor-type-id="split-provider[text-editor;markdown-preview-editor]">
         <state split_layout="SPLIT">
-          <first_editor relative-caret-position="442">
-            <caret line="17" column="46" lean-forward="true" selection-start-line="17" selection-start-column="46" selection-end-line="17" selection-end-column="46" />
+          <first_editor relative-caret-position="390">
+            <caret line="15" selection-start-line="15" selection-end-line="15" />
           </first_editor>
           <second_editor />
         </state>
@@ -370,8 +326,8 @@
     </entry>
     <entry file="file://$PROJECT_DIR$/book.db">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="234">
-          <caret line="9" column="1023" selection-start-line="9" selection-start-column="1023" selection-end-line="9" selection-end-column="1023" />
+        <state relative-caret-position="260">
+          <caret line="10" column="1023" selection-start-line="10" selection-start-column="1023" selection-end-line="10" selection-end-column="1023" />
         </state>
       </provider>
     </entry>
@@ -385,19 +341,6 @@
         </state>
       </provider>
     </entry>
-    <entry file="file://$PROJECT_DIR$/book.py">
-      <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="8684">
-          <caret line="341" column="18" selection-start-line="341" selection-start-column="18" selection-end-line="341" selection-end-column="18" />
-          <folding>
-            <element signature="e#24#35#0" expanded="true" />
-          </folding>
-        </state>
-      </provider>
-    </entry>
-    <entry file="file://$PROJECT_DIR$/templates/reader_book.html">
-      <provider selected="true" editor-type-id="text-editor" />
-    </entry>
     <entry file="file://$PROJECT_DIR$/templates/reader.html">
       <provider selected="true" editor-type-id="text-editor" />
     </entry>
@@ -415,6 +358,23 @@
       <provider selected="true" editor-type-id="text-editor">
         <state relative-caret-position="156">
           <caret line="6" column="14" selection-start-line="6" selection-start-column="14" selection-end-line="6" selection-end-column="14" />
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/templates/reader_book.html">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="962">
+          <caret line="37" lean-forward="true" selection-start-line="37" selection-end-line="37" />
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/book.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="167">
+          <caret line="367" column="16" lean-forward="true" selection-start-line="367" selection-start-column="16" selection-end-line="367" selection-end-column="16" />
+          <folding>
+            <element signature="e#24#35#0" expanded="true" />
+          </folding>
         </state>
       </provider>
     </entry>
Index: book.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- book.py	(revision 84f4180d3f8271428da2cf06e57b1fc961c0e900)
+++ book.py	(date 1558789236640)
@@ -368,9 +368,7 @@
     error = None
     book = query_db('''select * from books where book_id = ?''', [id], one=True)
     reader = query_db('''select * from borrows where book_id = ?''', [id], one=True)
-    count = query_db('''select count(book_id) from borrows where user_name = ? ''',
-                     [g.user], one=True)
-
+    count = query_db('''select count(book_id) from borrows where user_name = ? ''',[g.user], one=True)
     current_time = time.strftime('%Y-%m-%d', time.localtime(time.time()))
     return_time = time.strftime('%Y-%m-%d', time.localtime(time.time() + 2600000))
     if request.method == 'POST':
@@ -381,12 +379,8 @@
                 error = 'You can\'t borrow more than three books.'
             else:
                 db = get_db()
-                db.execute('''insert into borrows (user_name, book_id, date_borrow, \
-					date_return) values (?, ?, ?, ?) ''', [g.user, id,
-                                                           current_time, return_time])
-                db.execute('''insert into histroys (user_name, book_id, date_borrow, \
-					status) values (?, ?, ?, ?) ''', [g.user, id,
-                                                      current_time, 'not return'])
+                db.execute('''insert into borrows (user_name, book_id, date_borrow, \date_return) values (?, ?, ?, ?) ''', [g.user, id,current_time, return_time])
+                db.execute('''insert into histroys (user_name, book_id, date_borrow, \status) values (?, ?, ?, ?) ''', [g.user, id,current_time, 'not return'])
                 db.commit()
                 return redirect(url_for('reader_book', id=id))
         return render_template('reader_book.html', book=book, reader=reader, error=error)
Index: book.db
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>GBK
===================================================================
--- book.db	(revision 84f4180d3f8271428da2cf06e57b1fc961c0e900)
+++ book.db	(date 1558789237854)
@@ -1,9 +1,10 @@
 SQLite format 3   @     ÔøΩ   
            ÔøΩ                                                ÔøΩ .ÔøΩ   ÔøΩ    
 ÔøΩ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
-ÔøΩ ÔøΩ ,ÔøΩ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ÔøΩ ‰∏°+#123456pbkdf2:sha256:150000$JrvJTOSu$a928398a1831c7bf4188a05b43ab7c714eea6c1f8e47d2d7566008b8175533cdÁíÅÔºÑÁïªÈèàÂìÑÓÑüÈóÑÓî∞V1640428070@qq.com~ ‰∏°%12pbkdf2:sha256:150000$0sVsNx0D$e1f9210327c2e0a272081380dd6f1fd04710693dd7a6fb4b4e860eb2784a0cfefadas321a2dasd@232.com   TÔøΩ11pbkdf2:sha1:1000$ZPq8JK8f$138ea31dfef81fe392ab639b370c94a43200b907111111
+ÔøΩ  ,ÔøΩ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ÔøΩ
+ ‰∏°%JV164042pbkdf2:sha256:150000$PvcXdG2T$aa9f93470be5b4bc96b29910d7a898d3852e4112e46b02bb42324446bb654410ÈêûÂóó‰ºêÈñÆ‚ÜóV6404219234@qq.comÔøΩ ‰∏°+#123456pbkdf2:sha256:150000$JrvJTOSu$a928398a1831c7bf4188a05b43ab7c714eea6c1f8e47d2d7566008b8175533cdÁíÅÔºÑÁïªÈèàÂìÑÓÑüÈóÑÓî∞V1640428070@qq.com~ ‰∏°%12pbkdf2:sha256:150000$0sVsNx0D$e1f9210327c2e0a272081380dd6f1fd04710693dd7a6fb4b4e860eb2784a0cfefadas321a2dasd@232.com   TÔøΩ11pbkdf2:sha1:1000$ZPq8JK8f$138ea31dfef81fe392ab639b370c94a43200b907111111
    ÔøΩ ÔøΩÔøΩ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
-	histroy	users
+	histroy	users
     ÔøΩÔøΩVÔøΩZ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  @+73214213ÈèÅÁâàÂµÅÊê¥Êí≥Â∏´ÈêûÂóôÂ∏áÈêùÂ©áÁèÆÁªõÂ§ãÊöÄÈë≤ÊèíÂö≠ÈêóÂ†¢„Åû2018-4-10W'3199787020068425 ÈçêÂ∂àÓùÜÈîõÂ±ΩÊëúÊµºÔπÄÁ´∑ ÈëøÊèíÂüÑÈèÖÓÜôÈ£éÁ∂èÈèÇÔøΩ ÊµúÁÉòÁöØÈèÇÂõßÓÑüÈçëËôπÂ¢óÁªÄÔøΩ 2009-6-3S'3E!9787530201244 ÁªåÂóòÊüâÈèãÊ•ÉÊÆëÈíÅÓÑÇ„Åú ÈóáÂ∂àÊè™ ÈçñÊ§æÂê´Èçó‰ΩπÊπÄÈèÇÂõ™Â£ìÈçëËôπÂ¢óÁªÄÔøΩ 1988-12-1L'''99787507423846 ÂßäÔ∏æÊÆëÁëôÔΩÜÁÄΩ ÂØÆÊ•ÅÁ§áÊµºÂ©ÇÁóâ Ê∂ìÓÖûÊµóÈç©Â∫°Á´∂ÈçëËôπÂ¢óÁªÄÔøΩ 2011-1-1H'E#9787549529322 Èê™Â¨≠ÓùÜ ÈèåÊíÆÊΩ§ È™ûËÉØ„ÇøÁîØÂ†£ÂØñÊæ∂—ÉÓÑüÈçëËôπÂ¢óÁªÄÔøΩ 2013-01-01L'-!99787208061644 Êù©‰ªãÓóìÁªõÊøàÊÆëÊµúÔøΩ Èë≥¬§Á¶åÁÅèÔøΩ Ê∂ìÂ©ÉÊç£ÊµúÁÉòÁöØÈçëËôπÂ¢óÁªÄÔøΩ 2006-5-11111111111
    ÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              3214213'9787020068425'9787530201244'9787507423846'9787549529322'9787208061644	11
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
@@ -37,7 +38,7 @@
        date_borrow text not null,
        date_return text not null,
        primary key (user_name, book_id)
-)ÔøΩsÂÑÉtablehistroyshistroys	CREATE TABLE histroys(
+)ÔøΩÂÑÉtablehistroyshistroys	CREATE TABLE histroys(
        histroy_id integer primary key autoincrement,
        book_id text not null,
        user_name text not null,
@@ -50,8 +51,8 @@
        book_id text not null,
        date_borrow text not null,
        date_return text not null,
-       primary key (user_name, bo-rA indexsqlite_autoindex_borrows_1borrows	       
-      ÔøΩ ÔøΩÔøΩÔøΩ                                                                                                                                                                                           ‰πótÔøΩtableborrowsborrows
+       primary key (user_name, bo-~A indexsqlite_autoindex_borrows_1borrows	       
+      ÔøΩ ÔøΩÔøΩÔøΩ                                                                                                                                                                                          ‰πóÔøΩ ÔøΩtableborrowsborrows
 CREATE TABLE borrows(
        user_name text not null,
        book_id text not null,
@@ -71,7 +72,7 @@
        book_id text not null,
        date_borrow text not null,
        date_return text not null,
-       primary key (user_name, bo-uA indexsqlite_autoindex_borrows_1borrows	       
+       primary key (user_name, -ÔøΩA indexsqlite_autoindex_borrows_1borrows	   	     
     ÔøΩ  ÔøΩÔøΩÔøΩÔøΩÔøΩ                                                                                                                                                                                                                             ÔøΩ4‰æ¥tableusersusersCREATE TABLE users (
         user_id integer primary key autoincrement,
 	user_name text not null,
@@ -94,24 +95,18 @@
        primary key (user_name, book_id)
 
 )
-ÔøΩ  ÔøΩ ÔøΩ ÔøΩÔøΩÔøΩ                                                                                                                                                                                           ‰πótÔøΩtableborrowsborrows
-CREATE TABLE borrows(
-       user_name text not null,
-       book_id text not null,
-       date_borrow text not null,
-       date_return text not null,
-       primary key (user_name, book_id)
-)ÔøΩvÂÑÉtablehistroyshistroysCREATE TABLE histroys(
+   ÔøΩ ÔøΩÔøΩÔøΩÔøΩ                                                                                                                                                                                                                                                                                                                                                                                                                       ÔøΩÔøΩÂÑÉtablehistroyshistroysCREATE TABLE histroys(
        histroy_id integer primary key autoincrement,
        book_id text not null,
        user_name text not null,
        date_borrow text not null,
        date_return text,
        status text not null default 'not return'
-)/C indexsqlite_autoindex_historys_1historysÔøΩ ÔøΩÔøΩtableborrowsborrows
+)-ÔøΩA indexsqlite_autoindex_borrows_1borrows	‰πóÔøΩ ÔøΩtableborrowsborrows
 CREATE TABLE borrows(
        user_name text not null,
        book_id text not null,
        date_borrow text not null,
        date_return text not null,
-       primary key (user_name, bo-uA indexsqlite_autoindex_borrows_1borrows	       
\ No newline at end of file
+       primary key (user_name, book_id)
+)/C indexsqlite_autoindex_historys_1historys
\ No newline at end of file
